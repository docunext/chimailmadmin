<?xml version="1.0"?>
<map:sitemap xmlns:map="http://www.nexista.com/sitemap"> 
<!--
Program: Chi Mail Madmin
Component: Sitemap
Copyright: Savonix Corporation
Author: Albert L. Lash, IV
License: Gnu Affero Public License version 3
http://www.gnu.org/licenses

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation; either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program; if not, see http://www.gnu.org/licenses
or write to the Free Software Foundation,Inc., 51 Franklin Street,
Fifth Floor, Boston, MA 02110-1301  USA
-->
<map:prepend>
    <map:action type="server"/>
    <map:set name="theme" value="default"/>
    <map:script src="lib/php/runtime.php"/>
</map:prepend>



<map:gate name="index" >
    <map:xsl src="templates/xsl/welcome.xsl"/>
</map:gate>


<map:gate name="xpa-domain-list" >
    <map:query src="data/sql/domains_get_all.xml"/>
    <map:xsl src="templates/xsl/domain_list.xsl"/>
</map:gate>
<map:gate name="xpa-domain-edit" >
    <map:if name="//_post">
        <map:true>
            <map:if name="//_post/domain_id">
                <map:true>
                    <map:query src="data/sql/domain_update.xml"/>
                </map:true>
                <map:false>
                    <map:query src="data/sql/domain_create.xml"/>
                </map:false>
            </map:if>
            <map:action type="redirect" params="{//link_prefix}xpa-domain-list"/>
        </map:true>
        <map:false>
        </map:false>
    </map:if>
    <map:query src="data/sql/domain_get_by_id.xml"/>
    <map:xsl src="templates/xsl/domain_form.xsl"/>
</map:gate>


<map:gate name="xpa-mailbox-list" >
    <map:query src="data/sql/domains_get_all.xml"/>
    <map:query src="data/sql/mailboxes_get_all.xml"/>
    <map:xsl src="templates/xsl/mailbox_list.xsl"/>
</map:gate>
<map:gate name="xpa-mailbox-edit" >
    <map:if name="//_post">
        <map:true>
            <map:if name="//_post/mailbox_id">
                <map:true>
                    <map:query src="data/sql/mailbox_update.xml"/>
                </map:true>
                <map:false>
                    <map:query src="data/sql/mailbox_create.xml"/>
                </map:false>
            </map:if>
            <map:action type="redirect" params="{//link_prefix}xpa-domain-list"/>
        </map:true>
        <map:false>
        </map:false>
    </map:if>
    <map:xsl src="templates/xsl/mailbox_form.xsl"/>
</map:gate>

<map:gate name="xpa-alias-list">
    <map:xsl src="templates/xsl/alias_list.xsl"/>
</map:gate>
<map:gate name="xpa-alias-edit">
    <map:if name="//_post">
        <map:true>
            <map:if name="//_post/alias_id">
                <map:true>
                    <map:query src="data/sql/alias_update.xml"/>
                </map:true>
                <map:false>
                    <map:query src="data/sql/alias_create.xml"/>
                </map:false>
            </map:if>
            <map:action type="redirect" params="{//link_prefix}xpa-alias-list"/>
        </map:true>
        <map:false>
        </map:false>
    </map:if>
    <map:xsl src="templates/xsl/alias_form.xsl"/>
</map:gate>




<map:gate name="xpa-iframe-viewer">
    <map:xsl src="templates/xsl/iframe_viewer.xsl"/>
</map:gate>
<map:gate name="dynamic-css" cache="0">
    <map:action type="header" params="Content-Type,text/css"/>
    <map:xsl src="templates/css/default.css.xsl"/>
</map:gate>


<!-- Static Files -->
<!-- This type of file serving can be a huge
security hole, so make sure to only serve hard-coded, 
or mostly hard-coded files, i.e. have an array of allowed
files. -->
<!-- If you use the header action, you must set the cache to 0 -->
<map:gate name="license" cache="0">
    <map:action type="header" params="Content-Type,text/plain"/>
    <map:raw src="LICENSE" />
</map:gate>
<map:gate name="readme" cache="0">
    <map:action type="header" params="Content-Type,text/plain"/>
    <map:raw src="README" />
</map:gate>
<map:gate name="themed-css" cache="0">
    <map:action type="header" params="Content-Type,text/css"/>
    <map:raw src="templates/themes/default/style-1.css" />
</map:gate>



<map:gate name="xml-sitemap">
    <map:xml src="config/sitemap.xml"/>
    <map:xsl src="templates/xsl/xml-sitemap.xsl"/>
</map:gate>

</map:sitemap>
